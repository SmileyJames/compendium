{"version":3,"sources":["../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/shared.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/usePersist.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/host/useGameState.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/host/stores.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/host/funcs.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/usePeer.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/host/useConnections.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/host/useMoves.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/host/useSendSyncs.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/host/usePartyHost.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/guest/funcs.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/guest/useAck.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/guest/useSync.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/guest/useMoves.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/guest/useConnection.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/guest/usePartyGuest.js","../../.yarn/$$virtual/@compendium-peer-party-virtual-192a67fece/1/peer-party/src/guest/stores.js","../../compendium/tic-tac-toe/game/index.js","../../.yarn/$$virtual/@compendium-tic-tac-toe-host-virtual-bdcd2cbf8d/1/compendium/tic-tac-toe/host/dist/index.js","../../compendium/tic-tac-toe/guest/dist/index.js","compendium.js","../../.yarn/$$virtual/@compendium-tic-tac-toe-virtual-8c2105eed3/1/compendium/tic-tac-toe/index.js","rooms.js","Home.js","Router.js","App.js","reportWebVitals.js","index.js","../../.yarn/cache/peerjs-npm-1.3.1-878534ae62-2dc03823ec.zip/node_modules/peerjs/dist sync"],"names":["isSecretMove","connectionId","roomId","game","move","moveFn","getMoveFunction","Function","e","getMoves","hostMoves","guestMoves","constructReducer","events","state","reduce","o","event","output","args","seed","seedrandom","console","error","constructMoves","handleMove","Proxy","get","target","key","receiver","moves","hasOwnProperty","Symbol","iterator","keys","bind","Reflect","usePersist","store","defaultValue","useState","JSON","parse","getItem","setState","item","window","localStorage","useEffect","setItem","stringify","useGameState","eventLog","logSize","useRef","useStateStore","slice","current","length","updateState","genSeed","random","logEvent","setEventLog","destructPeer","setPeer","peer","destroy","opts","host","secure","usePeer","id","open","setOpen","useReducer","a","attempts","countAttempt","Peer","retry","timeout","setTimeout","on","clearTimeout","onConnectionClosed","useConnections","connections","setConnections","connectionLogSizeMap","conn","conns","appendConnection","index","isInteger","size","updateLogSizeMap","validMoves","isString","isObject","findIndex","m","validateEvent","Object","filter","c","removeConnection","useMoves","setMoves","constructMovesHandler","useSendSyncs","connection","numSent","map","i","send","usePartyHost","secret","useMemo","useEventLogStore","connectionIds","logSizeToIndex","useAck","connected","ack","useSync","data","clearData","setLogSize","updateLogSize","setCache","reducer","newState","cache","sync","preempt","emit","useConnection","setData","setConnected","connect","stream","usePartyGuest","uuid","useIdStore","useLogSizeStore","TicTacToe","fillSquare","player","crossesPlayer","noughtsPlayer","Error","board","position","splice","startGame","crossesConnId","noughtsConnId","Array","fill","Tile","styled","div","Board","Host","React","createElement","Fragment","Link","to","location","value","Button","button","TileOrButton","onClick","compendium","name","Guest","permutations","useConnectionId","setConnectionId","randomWords","exactly","join","getGame","compendiumIndex","words","split","sortedWords","sort","permutation","word","w","permu","isEqual","decodeCompendiumIndex","useGame","setGame","NewGame","onNewGame","set","onSubmit","onChange","preventDefault","onKeyPress","JoinGame","onJoinGame","Home","push","useHistory","order","createRoomId","HostRoute","useParams","GuestRoute","Router","path","exact","App","reportWebVitals","onPerfEntry","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById","webpackEmptyContext","req","code","resolve","module","exports"],"mappings":"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","file":"static/js/main.6638c04a.chunk.js","sourcesContent":["import seedrandom from \"seedrandom\";\n\nexport const isSecretMove = ({ connectionId, roomId, game, move }) => {\n  const moveFn = getMoveFunction({ connectionId, roomId, game, move });\n  try {\n    return (moveFn({}) instanceof Function);\n  } catch (e) {\n    return false;\n  }\n}\n\nconst getMoves = ({ connectionId, roomId, game }) => (\n  connectionId === roomId ? game.hostMoves : game.guestMoves\n);\n\nconst getMoveFunction = ({ connectionId, roomId, game, move }) => (\n  getMoves({ connectionId, roomId, game })[move]\n)\n\nexport const constructReducer = ({ game, events, roomId }) => (state) => {\n  try {\n    return events.reduce(\n      (o, event) => {\n        const moveFn = getMoveFunction({ connectionId: event.connectionId, roomId, game, move: event.move })\n        let output = moveFn({ state: o, connectionId: event.connectionId, args: event.args });\n        if (output instanceof Function && event.seed) {\n          const rng = seedrandom(event.seed);\n          output = output(rng);\n        }\n        return output;\n      },\n      state\n    );\n  } catch (e) {\n    console.error(e);\n    return state;\n  }\n}\n\nexport const constructMoves = ({ game, connectionId, roomId, handleMove }) => {\n  return new Proxy({}, {\n    get: (target, key, receiver) => {\n      const moves = getMoves({ connectionId, roomId, game });\n      if (moves.hasOwnProperty(key)) {\n        return (args) => handleMove({ move: key, args });\n      } else if (key === Symbol.iterator && moves) {\n        return moves.keys().bind(target)[Symbol.iterator]\n      } else {\n        return Reflect.get(target, key, receiver);\n      }\n    }\n  });\n}\n","import { useState, useEffect } from \"react\";\n\nconst usePersist = (store, key, defaultValue) => {\n  const [state, setState] = useState(\n    () => (\n      JSON.parse(store.getItem(key)) || \n      ((defaultValue instanceof Function) ? defaultValue() : defaultValue)\n    )\n  );\n\n  const [storedValue, setStoredValue] = useState(() => {\n    try {\n      const item = window.localStorage.getItem(key);\n      return item ? JSON.parse(item) : defaultValue;\n    } catch (error) {\n      console.error(error);\n      return defaultValue;\n    }\n  });\n\n  useEffect(() => {\n    store.setItem(key, JSON.stringify(state));\n  }, [key, state]);\n\n  return [state, setState];\n}\n\nexport default usePersist;\n","import { useRef, useEffect } from \"react\";\nimport { useStateStore } from \"./stores\";\nimport { constructReducer } from \"../shared\";\n\nconst updateState = ({ roomId, setState, game, events }) => {\n  const reducer = constructReducer({ game, roomId, events })\n  setState(reducer);\n}\n\nconst useGameState = ({ roomId, game, eventLog }) => {\n  const logSize = useRef();\n  const { state, setState } = useStateStore(roomId);\n  useEffect(() => {\n    const events = eventLog.slice(logSize.current || 0);\n    if (!roomId || !game || !events.length) return;\n    updateState({ roomId, setState, game, events });\n    logSize.current = eventLog.length;\n  }, [setState, roomId, game, eventLog, logSize])\n  return { state };\n}\n\nexport default useGameState\n","import usePersist from '../usePersist';\n\nexport const useStateStore = (roomId) => {\n  const [state, setState]  = usePersist(\n    window.localStorage,\n    `hostState-${roomId}`,\n    {}\n  );\n  return { state, setState }\n}\n\nexport const useEventLogStore = (roomId) => {\n  const [eventLog, setEventLog] = usePersist(\n    window.localStorage,\n    `eventLog-${roomId}`,\n    []\n  );\n  return { eventLog, setEventLog };\n}\n","import { isSecretMove } from \"../shared\";\n\nconst genSeed = (random) => random()\n\nexport const logEvent = ({ setEventLog, event, connectionId, roomId, game, random }) => {\n  const e = (\n    (isSecretMove({ connectionId, roomId, game, move: event.move }))\n      ? { ...event, connectionId, seed: genSeed(random) }\n      : { ...event, connectionId }\n  )\n  setEventLog(events => [...events, e]);\n}\n\n","import { useEffect, useRef, useState, useReducer } from \"react\";\nimport Peer from \"peerjs\";\n\nconst destructPeer = ({ setPeer }) => {\n  setPeer(peer => {\n    peer && peer.destroy();\n    return null\n  })\n};\n\nconst opts = { host: \"peerjs.92k.de\", secure: true };\n\nconst usePeer = (id) => {\n  const [peer, setPeer] = useState();\n  const [open, setOpen] = useState(false);\n  const [attempts, countAttempt] = useReducer(a => a + 1, 0);\n\n  useEffect(() => {\n    if (open) return;\n\n    const peer = new Peer(id, opts);\n    setPeer(peer);\n\n    const retry = () => {\n      setOpen(false);\n      destructPeer({ setPeer });\n      countAttempt();\n    };\n\n    let timeout = setTimeout(retry, 1000);\n\n    peer.on(\"open\", () => {\n      clearTimeout(timeout);\n      setOpen(true);\n    });\n\n    const onConnectionClosed = () => {\n      clearTimeout(timeout);\n      timeout = setTimeout(retry, 1000);\n    }\n    peer.on(\"close\", onConnectionClosed);\n    peer.on(\"disconnected\", onConnectionClosed);\n    peer.on(\"error\", onConnectionClosed);\n\n    return () => {\n      destructPeer({ setPeer });\n      clearTimeout(timeout);\n    }\n  }, [attempts, id])\n\n  return { open, peer }\n}\n\nexport default usePeer;\n","import { useRef, useState, useEffect, useMemo } from \"react\";\nimport { isString, isObject, isInteger } from \"lodash\";\nimport { logEvent } from \"./funcs\";\nimport usePeer from \"../usePeer\";\n\nconst validateEvent = (event, validMoves) => (\n  event &&\n  isString(event.move) && \n  isObject(event.args) &&\n  validMoves.findIndex((m) => m === event.move) > -1\n)\n\nconst appendConnection = ({ setConnections, conn }) => {\n  setConnections((conns) => [...conns, conn]);\n}\n\nconst removeConnection = ({ setConnections, conn }) => {\n  setConnections((conns) => conns.filter(c => c !== conn))\n}\n\nconst updateLogSizeMap = ({ conn, connectionLogSizeMap, size = 0 }) => {\n  connectionLogSizeMap.current[conn.peer] = size\n}\n\nconst useConnections = ({ game, roomId, eventLog, setEventLog, random }) => {\n  const { peer } = usePeer(roomId);\n  const [connections, setConnections] = useState([]);\n  const connectionLogSizeMap = useRef({});\n\n  useEffect(() => {\n    if (!peer) return;\n    peer.on(\"connection\", (conn) => {\n      conn.on(\"open\", () => {\n        appendConnection({ setConnections, conn });\n      });\n\n      conn.on(\"data\", ({ index, ...event }) => {\n        if (isInteger(index)) {\n          updateLogSizeMap({ conn, connectionLogSizeMap, size: index + 1 });\n        }\n        \n        if (\n          (isInteger(index) || index === null) &&\n          validateEvent(event, Object.keys(game.guestMoves))\n        ) {\n          logEvent({ setEventLog, event, connectionId: conn.peer, roomId, game, random });\n        }\n      })\n\n      conn.on(\"close\", () => {\n        removeConnection({ setConnections, conn });\n      });\n\n      conn.on(\"error\", (error) => {\n        console.error(conn.peer, error)\n      });\n    })\n\n  }, [peer, game, roomId])\n\n  return { connections, connectionLogSizeMap }\n}\n\nexport default useConnections;\n","import { useEffect, useState } from \"react\";\nimport { constructMoves } from \"../shared\";\nimport { logEvent } from \"./funcs\";\n\nconst constructMovesHandler = ({ setMoves, game, roomId, setEventLog, random }) => {\n  const handleMove = ({ move, args }) => {\n    logEvent({ setEventLog, event: { move, args }, connectionId: roomId, roomId, game, random })\n  };\n  setMoves(() => constructMoves({ game, connectionId: roomId, roomId, handleMove }))\n}\n\nconst useMoves = ({ roomId, game, setEventLog, random }) => {\n  const [moves, setMoves] = useState(null);\n\n  useEffect(() => {\n    if (!game) return;\n    constructMovesHandler({ setMoves, game, roomId, setEventLog, random });\n  }, [roomId, game, setEventLog]);\n\n  return { moves, setMoves }\n}\n\nexport default useMoves;\n","import { useEffect } from \"react\";\n\nconst useSendSyncs = ({ connections, connectionLogSizeMap, eventLog }) => {\n  useEffect(() => {\n    for (const connection of connections) {\n      const numSent = connectionLogSizeMap.current[connection.peer] || 0;\n      if (eventLog.length > numSent) {\n        const events = eventLog.slice(numSent)\n          .map((e, i) => ({ ...e, index: numSent + i }));\n        connection.send(events);\n      }\n    }\n  }, [connections, connectionLogSizeMap, eventLog]);\n};\n\nexport default useSendSyncs;\n","import seedrandom from \"seedrandom\";\nimport { useRef, useState, useEffect, useMemo } from \"react\";\nimport { constructMoves, constructReducer } from \"../shared\";\nimport { useStateStore, useEventLogStore } from \"./stores\";\nimport useGameState from \"./useGameState\";\nimport useConnections from \"./useConnections\";\nimport useMoves from \"./useMoves\";\nimport useSendSyncs from \"./useSendSyncs\";\n\n\nconst usePartyHost = ({ roomId, game, secret }) => {\n  const random = useMemo(() => seedrandom(secret || roomId), [secret, roomId]);\n  const { eventLog, setEventLog } = useEventLogStore(roomId);\n  const { state } = useGameState({ roomId, game, eventLog });\n  const { connections, connectionLogSizeMap } = useConnections({ game, roomId, eventLog, setEventLog, random})\n  const connectionIds = useMemo(() => connections.map(({ peer }) => peer), [connections])\n  const { moves } = useMoves({ roomId, game, setEventLog, random });\n  useSendSyncs({ connections, connectionLogSizeMap, eventLog });\n  return { state, moves, connections: connectionIds }\n}\n\nexport default usePartyHost;\n","export const logSizeToIndex = logSize => {\n  const index = logSize - 1;\n  return (index < 0) ? null : index;\n};\n","import { useEffect } from \"react\";\nimport { logSizeToIndex } from \"./funcs\";\n\nexport const ack = ({ conn, logSize }) => {\n  conn.current.send({ index: logSizeToIndex(logSize) })\n}\n\nconst useAck = ({ connected, conn, logSize }) => {\n  useEffect(() => {\n    if (!conn.current || !connected) return;\n    ack({ conn, logSize })\n  }, [connected, conn.current, logSize]);\n}\n\nexport default useAck;\n","import { useEffect } from \"react\";\nimport { constructReducer } from \"../shared\";\n\nconst sync = ({ setState, setCache, roomId, game, events }) => {\n  const reducer = constructReducer({ game, roomId, events })\n  setState(({ state }) => {\n    const newState = reducer(state);\n    return { state: newState, cache: newState }\n  });\n}\n\nconst updateLogSize = ({ setLogSize, events }) => {\n  setLogSize(events[events.length - 1].index + 1);\n}\n\nconst useSync = ({ data, clearData, game, roomId, setState, setLogSize }) => {\n  useEffect(() => {\n    if (!data || !data.length) return;\n    const events = [...data]\n    clearData();\n    updateLogSize({ setLogSize, events });\n    sync({ setState, roomId, game, events })\n  }, [data, clearData, game, roomId, setLogSize, setState])\n}\n\nexport default useSync;\n","import { useEffect, useState } from \"react\";\nimport { constructMoves, constructReducer, isSecretMove } from \"../shared\";\nimport { logSizeToIndex } from \"./funcs\";\n\nexport const emit = ({ conn, logSize, move, args }) => {\n  conn.current.send({ index: logSizeToIndex(logSize), move, args })\n}\n\nexport const preempt = ({ setState, game, move, args, connectionId, roomId }) => {\n  const reducer = constructReducer({ game, roomId, events: [{ move, args, connectionId }] })\n  setState(({ state, cache }) => ({\n    cache: reducer(state),\n    state,\n  }));\n}\n\nexport const constructMovesHandler = ({ conn, connectionId, setMoves, setState, game, logSize, roomId }) => {\n  const handleMove = ({ move, args }) => {\n    if (!isSecretMove({ connectionId, roomId, game, move })) {\n      preempt({ setState, game, move, args, roomId, connectionId })\n    }\n    emit({ conn, move, args, logSize })\n  }\n  setMoves(() => constructMoves({ game, connectionId, roomId, handleMove }));\n}\n\nconst useMoves = ({ connected, conn, id, setState, roomId, game, logSize }) => {\n  const [moves, setMoves] = useState(null);\n  useEffect(() => {\n    if (!connected) return;\n    constructMovesHandler({ conn, connectionId: id, setMoves, setState, roomId, game, logSize })\n  }, [connected, conn.current, id, setMoves, setState, roomId, game, logSize])\n  return { moves };\n}\n\nexport default useMoves;\n","import { useEffect, useRef, useState, useReducer } from \"react\";\nimport usePeer from \"../usePeer\";\n\nexport const connect = ({ roomId, peer, conn }) => {\n  conn.current = peer.connect(roomId);\n}\n\nconst useConnection = ({ id, roomId }) => {\n  const conn = useRef();\n  const { open, peer } = usePeer(id);\n  const [data, setData] = useState([]);\n  const [connected, setConnected] = useState(false);\n  const [attempts, countAttempt] = useReducer(a => a + 1, 0);\n\n  useEffect(() => {\n    if (!open || connected) return;\n\n    connect({ conn, peer, roomId });\n\n    const retry = () => {\n      conn.current = null;\n      setConnected(false);\n      countAttempt();\n    }\n    const timeout = setTimeout(retry, 1000);\n\n    conn.current.on(\"open\", () => {\n      clearTimeout(timeout);\n      setConnected(true); \n    });\n\n    conn.current.on(\"data\", (data) => {\n      setData((stream) => [...stream, ...data]);\n    });\n\n    conn.current.on(\"close\", () => {\n      clearTimeout(timeout);\n      retry();\n    });\n\n    conn.current.on(\"error\", (error) => {\n      console.error(error)\n    });\n\n  }, [attempts, open, connected, roomId]);\n\n  const clearData = () => setData([]);\n  return { connected: open && connected, conn, data, clearData }\n}\n\nexport default useConnection;\n","import useAck from \"./useAck\";\nimport useSync from \"./useSync\";\nimport useMoves from \"./useMoves\";\nimport useConnection from \"./useConnection\";\nimport { useIdStore, useStateStore, useLogSizeStore } from \"./stores\";\n\nconst usePartyGuest = ({ roomId, game }) => {\n  const { id } = useIdStore(roomId);\n  const { cache, setState } = useStateStore(roomId);\n  const { logSize, setLogSize } = useLogSizeStore(roomId);\n  const { connected, conn, data, clearData } = useConnection({ id, roomId })\n  useAck({ connected, conn, logSize });\n  useSync({ data, clearData, game, roomId, setState, setLogSize });\n  const { moves } = useMoves({ connected, conn, id, setState, roomId, game, logSize });\n  return { connected, state: cache, moves }\n}\n\nexport default usePartyGuest;\n","import usePersist from \"../usePersist\";\nimport { v4 as uuid } from \"uuid\";\n\nexport const useIdStore = (roomId) => {\n  const [id] = usePersist(\n    window.localStorage,\n    `id-${roomId}`,\n    uuid,\n  );\n  return { id };\n}\n\nexport const useStateStore = (roomId) => {\n  const [{ cache }, setState] = usePersist(\n    window.localStorage,\n    `guestState-${roomId}`,\n    { state: {}, cache: {} }\n  );\n  return { cache, setState };\n}\n\nexport const useLogSizeStore = (roomId) => {\n  const [logSize, setLogSize] = usePersist(\n    window.localStorage,\n    `logSize-${roomId}`,\n    0\n  );\n  return { logSize, setLogSize };\n}\n","export const NOUGHTS = 1;\nexport const CROSSES = 2;\n\nconst startGame = ({ state, connectionId, args }) => ({\n  crossesPlayer: args.crossesConnId,\n  noughtsPlayer: args.noughtsConnId,\n  board: Array(9).fill(null),\n});\n\nconst fillSquare = ({ state, connectionId, args }) => {\n  let player = null\n  if (connectionId === state.crossesPlayer) {\n    player = CROSSES;\n  } else if (connectionId === state.noughtsPlayer) {\n    player = NOUGHTS;\n  } else {\n    throw new Error('Connection is not a player');\n  }\n\n  if (state.board[args.position] !== null) {\n    throw new Error('Position filled');\n  }\n\n  const board = [...state.board];\n  board.splice(args.position, 1, player);\n\n  return ({\n    ...state,\n    board,\n  })\n}\n\nconst TicTacToe = {\n  guestMoves: {\n    fillSquare,\n  },\n  \n  hostMoves: {\n    startGame,\n  },\n}\n\nexport default TicTacToe;\n","import React, { useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport { NOUGHTS, CROSSES } from \"@compendium/tic-tac-toe-game\";\nconst Tile = styled.div`\n  width: 33.333%;\n  height: 33.333%;\n  background-color: cyan;\n  border: 2px solid yellow;\n  color: black;\n  text-align: center;\n  float: left;\n  box-sizing: border-box;\n`;\nconst Board = styled.div`\n  width: 30em;\n  height: 30em;\n`;\n\nconst Host = ({\n  state,\n  roomId,\n  moves,\n  connections\n}) => {\n  useEffect(() => {\n    if (!state.board && connections.length >= 2) {\n      const [crossesConnId, noughtsConnId] = connections;\n      moves.startGame({\n        crossesConnId,\n        noughtsConnId\n      });\n    }\n  }, [connections]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, connections.length < 2 && /*#__PURE__*/React.createElement(Link, {\n    to: `/guest/${roomId}`\n  }, window.location.host, \"#/guest/\", roomId), /*#__PURE__*/React.createElement(Board, null, state.board && state.board.map((value, position) => /*#__PURE__*/React.createElement(Tile, {\n    key: position\n  }, value === NOUGHTS ? \"O\" : null, value === CROSSES ? \"X\" : null))));\n};\n\nexport default Host;","import React from \"react\";\nimport styled from \"styled-components\";\nimport { NOUGHTS, CROSSES } from \"@compendium/tic-tac-toe-game\";\nconst Button = styled.button`\n  width: 33.333%;\n  height: 33.333%;\n  background-color: white;\n  border: 2px solid red;\n  color: black;\n  text-align: center;\n  float: left;\n  box-sizing: border-box;\n`;\nconst Tile = styled.div`\n  width: 33.333%;\n  height: 33.333%;\n  background-color: white;\n  border: 2px solid red;\n  color: black;\n  text-align: center;\n  float: left;\n  box-sizing: border-box;\n`;\nconst Board = styled.div`\n  width: 30em;\n  height: 30em;\n`;\n\nconst TileOrButton = ({\n  value,\n  onClick\n}) => value === null ? /*#__PURE__*/React.createElement(Button, {\n  onClick: onClick\n}) : /*#__PURE__*/React.createElement(Tile, null, value === NOUGHTS ? \"O\" : null, value === CROSSES ? \"X\" : null);\n\nconst Guest = ({\n  connected,\n  state,\n  moves\n}) => /*#__PURE__*/React.createElement(React.Fragment, null, connected ? null : /*#__PURE__*/React.createElement(\"p\", null, \"Disconnected..\"), /*#__PURE__*/React.createElement(Board, null, state.board && state.board.map((value, position) => /*#__PURE__*/React.createElement(TileOrButton, {\n  key: position,\n  value: value,\n  onClick: () => connected && moves.fillSquare({\n    position\n  })\n}))));\n\nexport default Guest;","import TicTacToe from \"@compendium/tic-tac-toe\";\n\nconst compendium = [\n  TicTacToe,\n];\n\nexport default compendium;\n","import game from \"@compendium/tic-tac-toe-game\";\nimport Host from \"@compendium/tic-tac-toe-host\";\nimport Guest from \"@compendium/tic-tac-toe-guest\";\n\nconst name = \"Tic Tac Toe\";\n\nconst TicTacToe = { name, Host, Guest, game };\n\nexport default TicTacToe;\n","import { useState, useEffect } from \"react\";\nimport compendium from \"./compendium\";\nimport randomWords from \"random-words\";\nimport isEqual from \"lodash/isEqual\";\n\nconst permutations = [\n  [0, 1, 2],\n  [0, 2, 1],\n  [1, 0, 2],\n  [2, 0, 1],\n  [2, 1, 0],\n  [1, 2, 0],\n];\n\nconst createConnectionId = () => randomWords({ exactly: 5 }).join('-');\n\nexport const useConnectionId = () => {\n  const [connectionId, setConnectionId] = useState();\n  useEffect(() => {\n    setConnectionId(() => createConnectionId())\n  }, []);\n  return connectionId;\n}\n\nexport const createRoomId = (compendiumIndex) => {\n  const order = permutations[compendiumIndex]\n  const words = randomWords({ exactly: 3 })\n  const sortedWords = words.sort()\n  const orderedWords = order.map(o => sortedWords[o])\n  const roomId = orderedWords.join('-')\n  return roomId\n}\n\nconst decodeCompendiumIndex = (roomId) => {\n  const words = roomId.split('-')\n  const sortedWords = words.sort()\n  const permutation = words.map(word => sortedWords.findIndex((w) => word === w))\n  const compendiumIndex = permutations.findIndex((permu) => isEqual(permu, permutation))\n  return compendiumIndex;\n}\n\nconst getGame = (roomId) => {\n  const compendiumIndex = decodeCompendiumIndex(roomId)\n  const game = compendium[compendiumIndex];\n  return game;\n}\n\nexport const useGame = (roomId) => {\n  const [game, setGame] = useState({ name: null, Host: null, Guest: null, game: null });\n  useEffect(() => setGame(getGame(roomId)), [])\n  return game;\n}\n","import { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { createRoomId } from \"./rooms\";\nimport compendium from \"./compendium\";\n\nconst NewGame = ({ onNewGame }) => {\n  const [value, set] = useState(0);\n\n  const onChange = (e) => {\n    set(e.target.value);\n    e.preventDefault();\n  }\n\n  const onSubmit = () => onNewGame(value);\n\n  return (\n    <>\n      <select onChange={onChange} value={value}>\n        {compendium.map(({ name }, index) =>\n          <option value={index} key={index}>{name}</option>)}\n      </select>\n      <button onClick={onSubmit} onKeyPress={onSubmit}>Host New Game</button>\n    </>\n  )\n}\n\nconst JoinGame = ({ onJoinGame }) => {\n  const [value, set] = useState();\n\n  const onChange = (e) => {\n    set(e.target.value);\n    e.preventDefault();\n  }\n\n  const onSubmit = () => onJoinGame(value);\n\n  return (\n    <>\n      <label>\n        Room Password\n        <input onChange={onChange} value={value}/>\n      </label>\n      <button onClick={onSubmit} onKeyPress={onSubmit}>Join Game</button>\n    </>\n  );\n}\n\n\nconst Home = () => {\n  const { push } = useHistory();\n\n  const onNewGame = (compendiumIndex) => {\n    const roomId = createRoomId(compendiumIndex);\n    push(`/host/${roomId}`)\n  }\n\n  const onJoinGame = (roomId) => {\n    push(`/guest/${roomId}`)\n  }\n\n  return (\n    <>\n      <NewGame onNewGame={onNewGame} />\n      <JoinGame onJoinGame={onJoinGame} />\n    </>\n  )\n}\n\n\nexport default Home;\n","import { usePartyHost, usePartyGuest } from \"@compendium/peer-party\";\nimport { HashRouter, Switch, Route, useParams } from \"react-router-dom\";\nimport { useGame, useConnectionId } from \"./rooms\";\nimport Home from \"./Home\";\n\nconst HostRoute = () => {\n  const { roomId } = useParams();\n  const { Host, game } = useGame(roomId);\n  const { state, moves, connections } = usePartyHost({ roomId, game });\n  return (\n    Host && <Host roomId={roomId} state={state} moves={moves} connections={connections} />\n  )\n}\n\nconst GuestRoute = () => {\n  const id = useConnectionId();\n  const { roomId } = useParams();\n  const { Guest, game } = useGame(roomId);\n  const { connected, state, moves } = usePartyGuest({ id, roomId, game });\n  return (\n    Guest && <Guest connectionId={id} roomId={roomId} connected={connected} state={state} moves={moves}/>\n  )\n}\n\nconst Router = () =>\n  <HashRouter>\n    <Switch>\n      <Route path=\"/host/:roomId\">\n        <HostRoute/>\n      </Route>\n      <Route path=\"/guest/:roomId\">\n        <GuestRoute/>\n      </Route>\n      <Route exact path=\"/\">\n        <Home/>\n      </Route>\n    </Switch>\n  </HashRouter>\n\nexport default Router;\n","import Router from \"./Router\";\n\nconst App = () =>\n  <Router/>\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 73;"],"sourceRoot":""}